<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coin Tapper</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, system-ui, sans-serif;
            background: var(--tg-theme-bg-color, #18222d);
            color: var(--tg-theme-text-color, #ffffff);
            text-align: center;
            min-height: 100vh;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .coins-display {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
            color: #ffd700;
        }
        
        .tap-area {
            width: 200px;
            height: 200px;
            background: linear-gradient(145deg, #ffd700, #ff6b00);
            border-radius: 50%;
            margin: 30px auto;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            user-select: none;
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
            border: 4px solid #fff;
            transition: all 0.1s;
        }
        
        .tap-area:active {
            transform: scale(0.95);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .stat-item {
            background: var(--tg-theme-secondary-bg-color, #2a3942);
            padding: 15px;
            border-radius: 12px;
            flex: 1;
            margin: 0 5px;
        }
        
        .shop {
            margin-top: 30px;
        }
        
        .shop-item {
            background: var(--tg-theme-secondary-bg-color, #2a3942);
            padding: 15px;
            margin: 10px 0;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .buy-btn {
            background: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí∞ Coin Tapper</h1>
        
        <div class="coins-display" id="coins">0</div>
        
        <div class="tap-area" id="tapButton">
            TAP ME!
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div>Per Tap</div>
                <div id="perTap">1</div>
            </div>
            <div class="stat-item">
                <div>Total Taps</div>
                <div id="totalTaps">0</div>
            </div>
        </div>
        
        <div class="shop">
            <h3>üè™ Upgrade Shop</h3>
            
            <div class="shop-item">
                <div>
                    <strong>Better Fingers</strong><br>
                    +1 coin per tap
                </div>
                <button class="buy-btn" onclick="buyUpgrade('tapPower', 10)">
                    Buy (10 coins)
                </button>
            </div>
            
            <div class="shop-item">
                <div>
                    <strong>Auto Tapper</strong><br>
                    +1 coin every 5 seconds
                </div>
                <button class="buy-btn" onclick="buyUpgrade('autoTap', 50)">
                    Buy (50 coins)
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            coins: 0,
            totalTaps: 0,
            tapPower: 1,
            autoTapLevel: 0,
            upgrades: {
                tapPower: 0,
                autoTap: 0
            }
        };

        // Initialize Telegram
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();

        // Load saved game
        function loadGame() {
            const saved = localStorage.getItem('coinTapperSave');
            if (saved) {
                gameState = { ...gameState, ...JSON.parse(saved) };
            }
            updateDisplay();
        }

        // Save game
        function saveGame() {
            localStorage.setItem('coinTapperSave', JSON.stringify(gameState));
        }

        // Update display
        function updateDisplay() {
            document.getElementById('coins').textContent = formatNumber(gameState.coins);
            document.getElementById('perTap').textContent = gameState.tapPower;
            document.getElementById('totalTaps').textContent = gameState.totalTaps;
        }

        // Format large numbers
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // Tap function
        function tap() {
            gameState.coins += gameState.tapPower;
            gameState.totalTaps++;
            updateDisplay();
            saveGame();
            
            // Add visual feedback
            const tapBtn = document.getElementById('tapButton');
            tapBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                tapBtn.style.transform = 'scale(1)';
            }, 100);
        }

        // Buy upgrade
        function buyUpgrade(type, cost) {
            if (gameState.coins >= cost) {
                gameState.coins -= cost;
                
                if (type === 'tapPower') {
                    gameState.tapPower++;
                    gameState.upgrades.tapPower++;
                    // Increase cost for next purchase
                    cost = Math.floor(cost * 1.5);
                    document.querySelector(`button[onclick="buyUpgrade('${type}', ${cost})"]`)
                        .innerHTML = `Buy (${cost} coins)`;
                }
                else if (type === 'autoTap') {
                    gameState.autoTapLevel++;
                    gameState.upgrades.autoTap++;
                    // Increase cost for next purchase
                    cost = Math.floor(cost * 2);
                    document.querySelector(`button[onclick="buyUpgrade('${type}', ${cost})"]`)
                        .innerHTML = `Buy (${cost} coins)`;
                }
                
                updateDisplay();
                saveGame();
            }
        }

        // Auto-tap system
        function autoTap() {
            if (gameState.autoTapLevel > 0) {
                gameState.coins += gameState.autoTapLevel;
                updateDisplay();
                saveGame();
            }
        }

        // Set up event listeners
        document.getElementById('tapButton').addEventListener('click', tap);

        // Initialize game
        loadGame();
        
        // Set up auto-tap interval (every 5 seconds)
        setInterval(autoTap, 5000);

        // Set up Telegram Main Button
        Telegram.WebApp.MainButton.setText(`Share Game`)
            .onClick(() => {
                // This would share the game link
                Telegram.WebApp.openTelegramLink('https://t.me/your_bot?start=game');
            })
            .show();
    </script>
</body>
</html>